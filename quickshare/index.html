<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUICKSHARE</title>
    <style>
        :root { --neon: #00ff88; --bg: #020617; --card: #0f172a; --border: #334155; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; min-height: 100vh; }
        .container { max-width: 800px; margin: 30px auto; padding: 25px; background: var(--card); border-radius: 12px; border: 1px solid var(--border); position: relative; z-index: 10; }
        textarea { width: 100%; height: 250px; background: #000; color: var(--neon); border: 1px solid #1e293b; padding: 12px; border-radius: 8px; outline: none; box-sizing: border-box; font-family: monospace; }
        .btn { padding: 12px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 12px; text-transform: uppercase; transition: 0.3s; }
        .btn-main { background: var(--neon); color: #020617; }
        .btn-upload { background: #3b82f6; color: white; margin-bottom: 10px; display: inline-flex; align-items: center; gap: 8px; }
        #file-info { font-size: 12px; color: #94a3b8; margin-bottom: 10px; display: none; }
        header { background: rgba(0,0,0,0.8); padding: 15px 5%; display: flex; justify-content: space-between; border-bottom: 1px solid #1e293b; }
        footer { text-align: center; padding: 20px; color: #475569; font-size: 11px; }
    </style>
</head>
<body>

<header>
    <div style="color:var(--neon); font-weight:bold; font-size:22px; cursor:pointer" onclick="location.href=window.location.origin + window.location.pathname">‚ùÑÔ∏è QUICKSHARE</div>
    <div id="auth-info"></div>
</header>

<div class="container" id="view-page" style="display:none">
    <h2 id="view-title" style="color:var(--neon);"></h2>
    <div id="view-meta" style="font-size:12px; color:#64748b; margin-bottom:15px;"></div>
    <div id="file-download-zone" style="display:none; background:#1e293b; padding:15px; border-radius:8px; margin-bottom:15px;">
        <p style="margin:0 0 10px 0; font-size:14px;">üìé Attached File detected</p>
        <button class="btn btn-main" id="dl-btn">Download Attachment</button>
    </div>
    <textarea id="view-content" readonly></textarea>
</div>

<div class="container" id="create-page">
    <div style="display:flex; gap:10px; align-items:center; margin-bottom:15px;">
        <input type="text" id="share-title" style="flex:1; background:#1e293b; border:1px solid var(--border); color:white; padding:12px; border-radius:6px;" placeholder="Filename / Title *">
        <label class="btn btn-upload">
            üìÅ Upload File
            <input type="file" id="file-input" style="display:none" onchange="handleFileUpload(this)">
        </label>
    </div>
    
    <div id="file-info"></div>
    <textarea id="editor" placeholder="Type content or add file description here..."></textarea>
    
    <div style="margin-top:15px;">
        <input type="checkbox" id="captcha-in"> <label style="font-size:13px;">QuickCaptcha</label>
    </div>
    <button class="btn btn-main" style="width:100%; margin-top:15px;" onclick="saveShare()">üöÄ Publish Share</button>
</div>

<footer>Made by GitHub Pages!</footer>

<script>
    let attachedFileData = null;
    let attachedFileName = null;
    const me = localStorage.getItem('loggedUser');

    function handleFileUpload(input) {
        const file = input.files[0];
        if (!file) return;

        attachedFileName = file.name;
        document.getElementById('share-title').value = file.name;
        const info = document.getElementById('file-info');
        info.style.display = "block";
        info.innerText = "Selected: " + file.name + " (" + (file.size/1024).toFixed(1) + " KB)";

        const reader = new FileReader();
        
        // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, —á–∏—Ç–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
        if (file.type.startsWith('text/') || file.name.endsWith('.js') || file.name.endsWith('.css') || file.name.endsWith('.json')) {
            reader.onload = (e) => {
                document.getElementById('editor').value = e.target.result;
            };
            reader.readAsText(file);
        } else {
            // –ï—Å–ª–∏ –±–∏–Ω–∞—Ä–Ω—ã–π, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ DataURL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
            reader.onload = (e) => {
                attachedFileData = e.target.result;
                document.getElementById('editor').placeholder = "Enter description for this file...";
            };
            reader.readAsDataURL(file);
        }
    }

    function saveShare() {
        const t = document.getElementById('share-title').value;
        const c = document.getElementById('editor').value;
        if(!t) return alert("Title required!");

        const data = { 
            t, c, 
            u: me || 'Guest', 
            ts: Date.now(),
            file: attachedFileData,
            fileName: attachedFileName
        };
        
        const s = btoa(unescape(encodeURIComponent(JSON.stringify(data))));
        location.href = window.location.origin + window.location.pathname + "?s=" + s;
    }

    window.onload = () => {
        const sParam = new URLSearchParams(window.location.search).get('s');
        if(sParam) {
            document.getElementById('create-page').style.display = 'none';
            document.getElementById('view-page').style.display = 'block';
            const data = JSON.parse(decodeURIComponent(escape(atob(sParam))));
            
            document.getElementById('view-title').innerText = data.t;
            document.getElementById('view-content').value = data.c || "No description provided.";
            document.getElementById('view-meta').innerText = "By " + data.u + " at " + new Date(data.ts).toLocaleString();

            if(data.file) {
                const zone = document.getElementById('file-download-zone');
                zone.style.display = "block";
                document.getElementById('dl-btn').onclick = () => {
                    const a = document.createElement('a');
                    a.href = data.file;
                    a.download = data.fileName || "download";
                    a.click();
                };
            }
        }
        if(me) document.getElementById('auth-info').innerText = me + " üéÑ";
    };
</script>
</body>
</html>
