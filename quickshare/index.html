<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUICKSHARE</title>
    <style>
        :root { --neon: #00ff88; --bg: #020617; --card: #0f172a; --red: #ff4444; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; min-height: 100vh; display: flex; flex-direction: column; }
        .logged-in-bg { background: radial-gradient(circle at center, #0a192f, #020617) !important; }
        
        #snow-canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1; display: none; }
        .garland { position: fixed; top: 0; width: 100%; height: 6px; background: linear-gradient(90deg, #f00 25%, #0f0 25%, #0f0 50%, #00f 50%, #00f 75%, #ff0 75%); background-size: 40px 100%; animation: flash 1s infinite linear; display: none; z-index: 1000; }
        @keyframes flash { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }

        header { background: rgba(0,0,0,0.8); padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #1e293b; position: sticky; top: 0; z-index: 100; }
        .main-content { flex: 1; padding: 10px; }
        .container { max-width: 900px; margin: 10px auto; padding: 25px; background: var(--card); border-radius: 15px; border: 1px solid #334155; position: relative; z-index: 10; }
        
        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å–≤–µ—Ä—Ö—É */
        textarea { width: 100%; height: 350px; background: #000; color: var(--neon); border: 1px solid #1e293b; padding: 15px; box-sizing: border-box; font-family: monospace; border-radius: 8px; outline: none; margin-bottom: 20px; }
        
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥ —Ç–µ–∫—Å—Ç–æ–º */
        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        input, select { background: #1e293b; border: 1px solid #334155; color: white; padding: 12px; border-radius: 6px; width: 100%; box-sizing: border-box; }
        
        .btn { padding: 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; text-transform: uppercase; transition: 0.2s; font-size: 12px; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-main { background: var(--neon); color: #020617; }
        .btn-sec { background: #334155; color: white; }
        
        /* Captcha Styles */
        #captcha-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .monster-btn { font-size: 60px; background: none; border: none; cursor: pointer; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .hp-bar { width: 250px; height: 15px; background: #333; border: 2px solid white; margin: 15px; border-radius: 10px; overflow: hidden; }
        #hp-fill { width: 100%; height: 100%; background: var(--red); transition: 0.2s; }
        .hold-btn { width: 140px; height: 140px; border-radius: 50%; border: 6px solid var(--neon); background: none; color: var(--neon); font-weight: bold; cursor: pointer; display: none; }

        footer { text-align: center; padding: 20px; color: #475569; font-size: 11px; }
    </style>
</head>
<body id="body-tag">

<div class="garland" id="garland"></div>
<canvas id="snow-canvas"></canvas>

<header>
    <div style="color:var(--neon); font-weight:bold; font-size:24px; cursor:pointer" onclick="location.href='./'">‚ùÑÔ∏è QUICKSHARE</div>
    <div id="auth-box"></div>
</header>

<div id="captcha-overlay">
    <div id="step-monster">
        <h2 style="color:var(--red)">DEFEAT THE GUARDIAN!</h2>
        <button class="monster-btn" id="monster" onclick="hitMonster()">üëæ</button>
        <div class="hp-bar"><div id="hp-fill"></div></div>
        <p id="hp-text">100 / 100 HP</p>
    </div>
    <div id="step-hold" style="display:none">
        <h2 style="color:var(--neon)">SHARECAPTCHA VERIFICATION</h2>
        <p>Hold the button for 5 seconds</p>
        <button class="hold-btn" id="hold-trigger">HOLD</button>
        <div class="hp-bar" style="border-color:var(--neon)"><div id="hold-fill" style="width:0%; background:var(--neon)"></div></div>
    </div>
    <div id="step-feedback" style="display:none">
        <h2>Did you like our ShareCaptcha?</h2>
        <div style="display:flex; gap:20px; margin-top:20px;">
            <button class="btn btn-main" style="width:100px" onclick="finishCaptcha(true)">YES</button>
            <button class="btn btn-sec" style="background:var(--red); width:100px" onclick="finishCaptcha(false)">NO</button>
        </div>
        <h3 id="final-msg" style="margin-top:20px; display:none"></h3>
    </div>
</div>

<div class="main-content">
    <div class="container">
        <input type="text" id="share-title" placeholder="Filename / Title *" style="margin-bottom: 15px;">
        <textarea id="editor" placeholder="Write your code or paste text here..."></textarea>
        
        <div id="auth-features" style="display:none; margin-top:10px;">
            <div class="settings-grid" style="margin-bottom: 15px;">
                <input type="text" id="share-tags" placeholder="Tags (e.g. py, web, notes)">
                <input type="password" id="share-pass" placeholder="Password (Optional)">
            </div>
            <div class="settings-grid" style="margin-bottom: 15px;">
                <select id="share-expiry">
                    <option value="0">Life: Permanent</option>
                    <option value="24">Expire in 24 Hours</option>
                    <option value="72">Expire in 72 Hours</option>
                </select>
                <label style="display:flex; align-items:center; gap:10px; font-size:13px; cursor:pointer">
                    <input type="checkbox" id="use-captcha" style="width:auto"> Enable ShareCaptcha
                </label>
            </div>
        </div>

        <div class="settings-grid">
            <button class="btn btn-sec" id="btn-upload" onclick="document.getElementById('file-upload').click()">üìÇ Upload File</button>
            <input type="file" id="file-upload" style="display:none" onchange="handleFileUpload(this)">
            <button class="btn btn-main" onclick="generateShare()">üöÄ Publish Share</button>
        </div>
    </div>
</div>

<footer>
    Made by GitHub Pages!
</footer>

<script>
    const user = localStorage.getItem('loggedUser');
    const isAuth = !!user;

    if(isAuth) {
        document.getElementById('body-tag').classList.add('logged-in-bg');
        document.getElementById('garland').style.display = 'block';
        document.getElementById('auth-features').style.display = 'block';
        initSnow();
    } else {
        document.getElementById('btn-upload').disabled = true;
        document.getElementById('btn-upload').style.opacity = "0.5";
    }

    document.getElementById('auth-box').innerHTML = isAuth ? 
        `${user} | <button class="btn btn-sec" style="padding:5px 10px; display:inline" onclick="localStorage.removeItem('loggedUser');location.reload()">EXIT</button>` :
        `<button class="btn btn-sec" onclick="location.href='./login'">LOGIN</button>`;

    // –§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞
    function handleFileUpload(input) {
        const file = input.files[0];
        if(!file) return;

        const reader = new FileReader();
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏–ª–∏ –∫–æ–¥
        if (file.type.startsWith('text/') || file.name.match(/\.(py|js|html|css|json|sh|php|txt)$/)) {
            reader.onload = (e) => {
                document.getElementById('editor').value = e.target.result;
                document.getElementById('share-title').value = file.name;
            };
            reader.readAsText(file);
        } else {
            // –ï—Å–ª–∏ —ç—Ç–æ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª (zip, apk, exe)
            document.getElementById('editor').value = "[BINARY FILE: " + file.name + "]\nSize: " + (file.size/1024).toFixed(2) + " KB\nThis file will be available for download.";
            document.getElementById('share-title').value = file.name;
        }
    }

    function generateShare() {
        const title = document.getElementById('share-title').value;
        const text = document.getElementById('editor').value;
        if(!title || !text) return alert("Title and Content are required!");

        const data = {
            t: title,
            c: text,
            tags: isAuth ? document.getElementById('share-tags').value.split(',') : [],
            p: isAuth ? document.getElementById('share-pass').value : '',
            expiry: isAuth ? document.getElementById('share-expiry').value : 72,
            captcha: isAuth && document.getElementById('use-captcha').checked,
            ts: Date.now(),
            u: user || 'Guest'
        };

        const link = window.location.origin + window.location.pathname + "?s=" + btoa(unescape(encodeURIComponent(JSON.stringify(data))));
        prompt("Your Link:", link);
    }

    // --- CAPTCHA LOGIC ---
    let hp = 100;
    function hitMonster() {
        hp -= 10;
        document.getElementById('hp-fill').style.width = hp + "%";
        document.getElementById('hp-text').innerText = hp + " / 100 HP";
        if(hp <= 0) {
            document.getElementById('step-monster').style.display = 'none';
            document.getElementById('step-hold').style.display = 'block';
            document.getElementById('hold-trigger').style.display = 'block';
        }
    }

    let hTimer, hProg = 0;
    const hBtn = document.getElementById('hold-trigger');
    hBtn.onmousedown = hBtn.ontouchstart = () => {
        hTimer = setInterval(() => {
            hProg += 2;
            document.getElementById('hold-fill').style.width = hProg + "%";
            if(hProg >= 100) { clearInterval(hTimer); document.getElementById('step-hold').style.display='none'; document.getElementById('step-feedback').style.display='block'; }
        }, 100);
    };
    window.onmouseup = window.ontouchend = () => { clearInterval(hTimer); hProg = 0; document.getElementById('hold-fill').style.width = "0%"; };

    function finishCaptcha(ok) {
        const msg = document.getElementById('final-msg');
        msg.style.display = 'block';
        msg.innerText = ok ? "Thank You! ‚ù§Ô∏è" : "Sorry! We are working to improve quality.";
        setTimeout(() => { document.getElementById('captcha-overlay').style.display = 'none'; location.reload(); /* –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */ }, 3000);
    }

    function initSnow() {
        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        canvas.style.display = 'block';
        let W = window.innerWidth, H = window.innerHeight;
        canvas.width = W; canvas.height = H;
        let flakes = Array.from({length: 60}, () => ({x: Math.random()*W, y: Math.random()*H, r: Math.random()*3+1, d: Math.random()*1}));
        function draw() {
            ctx.clearRect(0, 0, W, H); ctx.fillStyle = "white"; ctx.beginPath();
            flakes.forEach(f => { ctx.moveTo(f.x, f.y); ctx.arc(f.x, f.y, f.r, 0, Math.PI*2, true); });
            ctx.fill();
            flakes.forEach(f => { f.y += f.d + 1; if(f.y > H) f.y = -10; });
            requestAnimationFrame(draw);
        }
        draw();
    }
</script>
</body>
</html>
